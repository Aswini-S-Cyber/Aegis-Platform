<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Aegis Platform - Enterprise Platform</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --background: #1A0A33; /* Deep Indigo Background Color */
            --card-bg: #161B22; --border-color: #30363D;
            --text-primary: #C9D1D9; --text-secondary: #8B949E;
            --accent-blue: #58A6FF; --accent-green: #3FB950; --accent-yellow: #D29922; --accent-red: #F85149;
        }
        body { 
            font-family: 'Inter', sans-serif; 
            color: var(--text-primary); 
            /* NEW BACKGROUND IMAGE WITH DARK OVERLAY */
            background-image: 
                /* 85% opacity overlay to keep text readable */
                linear-gradient(rgba(26, 10, 51, 0.9), rgba(26, 10, 51, 0.9)), 
                /* Abstract/Tech image for visual theme */
                url('https://picsum.photos/1920/1080?technology'); 
            background-size: cover;
            background-attachment: fixed;
            background-color: var(--background); /* Fallback */
        }
        .card { background-color: var(--card-bg); border: 1px solid var(--border-color); }
        .sidebar-link.active, .sidebar-link:hover { background-color: rgba(88, 166, 255, 0.1); color: var(--accent-blue); border-left: 3px solid var(--accent-blue); padding-left: calc(0.75rem - 3px); }
        .view { display: none; animation: fadeIn 0.4s ease-in-out; }
        .view.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .kpi-card { transition: all 0.2s ease; cursor: pointer; }
        .kpi-card:hover { transform: translateY(-5px); box-shadow: 0 0 15px rgba(88, 166, 255, 0.2); }
        .modal-backdrop { background-color: rgba(0,0,0,0.7); backdrop-filter: blur(4px); }
        .time-slot.selected { background-color: var(--accent-blue); color: var(--background); }
        #voice-search-btn.listening { color: var(--accent-red); animation: pulse 1.5s infinite; }
        @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.2); } }
        .progress-bar-fill { transition: width 0.5s ease-in-out; }
    </style>
</head>
<body class="h-screen text-sm">

    <div id="login-screen" class="w-full h-full flex items-center justify-center bg-cover" style="background-image: url('https://picsum.photos/1920/1080?abstract&blur=2');">
        <div class="card p-8 rounded-lg shadow-2xl text-center w-full max-w-sm">
            <h1 class="text-3xl font-bold mb-2">The Aegis Platform</h1>
            <p class="text-secondary mb-8">Select Your Portal</p>
            <div class="space-y-4">
                <button class="w-full bg-blue-600 text-white font-bold py-3 rounded-lg hover:bg-blue-700 transition-all" data-portal="payer">Payer Administrator</button>
                <button class="w-full bg-gray-700 text-white font-bold py-3 rounded-lg hover:bg-gray-600 transition-all" data-portal="provider">Provider Portal</button>
                <button class="w-full bg-gray-700 text-white font-bold py-3 rounded-lg hover:bg-gray-600 transition-all" data-portal="member">Member Directory</button>
            </div>
        </div>
    </div>

    <div id="app-shell" class="h-full w-full flex hidden">
        <aside class="w-64 card flex-shrink-0 flex flex-col border-r">
            <div class="p-6 text-center border-b border-[var(--border-color)]">
                <h1 class="text-2xl font-bold text-[var(--accent-blue)]">Aegis Platform</h1>
            </div>
            <nav class="p-4 flex-grow"><ul id="sidebar-nav" class="space-y-2"></ul></nav>
            <div class="p-4 border-t border-[var(--border-color)]">
                <div class="flex items-center">
                    <div class="w-10 h-10 rounded-full bg-[var(--accent-blue)] text-white flex items-center justify-center font-bold">AS</div>
                    <div class="ml-3"><p class="font-semibold">Aswini S</p><p id="user-role" class="text-xs text-secondary"></p></div>
                </div>
                <button id="logout-btn" class="w-full mt-4 text-left p-3 font-semibold rounded-lg hover:bg-red-900/50 text-red-400 flex items-center"><span class="mr-3 text-2xl">ðŸšª</span>Logout</button>
            </div>
        </aside>
        <div class="flex-1 flex flex-col overflow-hidden">
            <header class="card shadow-md p-4 flex justify-between items-center border-b">
                <h2 id="header-title" class="text-xl font-bold"></h2>
                <div class="flex items-center space-x-4">
                     <input id="global-search" type="text" placeholder="Search..." class="w-64 pl-4 pr-4 py-2 rounded-lg border border-[var(--border-color)] bg-transparent focus:outline-none focus:ring-2 focus:ring-[var(--accent-blue)]">
                     <button class="p-2 rounded-full text-xl hover:bg-gray-700"><span>ðŸ””</span></button>
                </div>
            </header>
            <main id="main-content" class="flex-1 overflow-x-hidden overflow-y-auto p-6"></main>
        </div>
    </div>
    
    <div id="modal-container" class="fixed inset-0 modal-backdrop items-center justify-center hidden z-50"></div>
    
    <script>
    const App = {
        state: { portal: null, providerData: [], charts: {}, loggedInProviderId: 4 },
        init() {
            this.generateData();
            document.getElementById('login-screen').addEventListener('click', e => e.target.dataset.portal && this.login(e.target.dataset.portal));
            document.getElementById('logout-btn').addEventListener('click', () => this.logout());
            document.getElementById('sidebar-nav').addEventListener('click', e => {
                const link = e.target.closest('a');
                if (link) { e.preventDefault(); this.switchView(link.dataset.view); }
            });
        },
        login(portal) {
            this.state.portal = portal;
            document.getElementById('login-screen').classList.add('hidden');
            document.getElementById('app-shell').classList.remove('hidden');
            this.renderShell();
            this.switchView(Object.keys(this.portals[portal].views)[0]);
        },
        logout() {
            this.state.portal = null;
            document.getElementById('login-screen').classList.remove('hidden');
            document.getElementById('app-shell').classList.add('hidden');
        },
        renderShell() {
            const portalConfig = this.portals[this.state.portal];
            document.getElementById('user-role').textContent = portalConfig.role;
            const nav = document.getElementById('sidebar-nav');
            nav.innerHTML = Object.entries(portalConfig.views).map(([key, view]) => `<li><a href="#" class="sidebar-link flex items-center p-3 font-semibold rounded-lg" data-view="${key}"><span class="mr-3 text-2xl">${view.icon}</span>${view.title}</a></li>`).join('');
        },
        switchView(viewId) {
            const mainContent = document.getElementById('main-content');
            mainContent.innerHTML = '';
            document.querySelectorAll('#sidebar-nav a').forEach(a => a.classList.remove('active'));
            document.querySelector(`#sidebar-nav a[data-view="${viewId}"]`).classList.add('active');
            
            const viewConfig = this.portals[this.state.portal].views[viewId];
            document.getElementById('header-title').textContent = viewConfig.title;
            const viewElement = document.createElement('div');
            viewElement.className = 'view active';
            viewElement.innerHTML = viewConfig.render();
            mainContent.appendChild(viewElement);
            viewConfig.postRender?.(this);
        },
        generateData() {
            const names = ["Dr. Priya Sharma", "Dr. Rohan Gupta", "Dr. Anjali Desai", "Dr. Vikram Singh", "Dr. Sneha Patel", "Dr. Aditya Kumar", "Dr. Meera Krishnan", "Dr. Arjun Reddy", "Dr. Aisha Khan", "Dr. Sameer Joshi"];
            const cities = ["Mumbai", "Delhi", "Bangalore", "Chennai", "Kolkata", "Hyderabad", "Pune", "Ahmedabad", "Jaipur"];
            const specialties = ["Cardiology", "Orthopedics", "Pediatrics", "Dermatology", "Neurology", "Gastroenterology", "Ophthalmology", "ENT"];
            const errors = ['Address Mismatch', 'Phone Unverified', 'License Expired', 'Specialty Mismatch'];
            
            // Image links sourced from a public placeholder service
            const picUrls = [
                'https://randomuser.me/api/portraits/men/1.jpg', 
                'https://randomuser.me/api/portraits/women/2.jpg', 
                'https://randomuser.me/api/portraits/men/3.jpg', 
                'https://randomuser.me/api/portraits/women/4.jpg', 
                'https://randomuser.me/api/portraits/men/5.jpg', 
                'https://randomuser.me/api/portraits/women/6.jpg', 
                'https://randomuser.me/api/portraits/men/7.jpg', 
                'https://randomuser.me/api/portraits/women/8.jpg', 
                'https://randomuser.me/api/portraits/men/9.jpg', 
                'https://randomuser.me/api/portraits/women/10.jpg',
            ];
            
            this.state.providerData = Array.from({length: 100}, (_, i) => ({
                id: i, 
                name: names[i % names.length], 
                npi: `${Math.floor(1000000000 + Math.random() * 9000000000)}`, 
                specialty: specialties[i % specialties.length], 
                address: `${i+1} Main St, ${cities[i % cities.length]}`, 
                phone: `(022) 2${Math.floor(100 + Math.random() * 900)}${Math.floor(1000 + Math.random() * 9000)}`,
                error: i < 12 ? errors[i % errors.length] : 'None', 
                confidence: i < 12 ? (i < 6 ? 'Low' : 'Medium') : 'High', 
                profilePic: picUrls[i % picUrls.length] /* Using the realistic links */
            }));
        },
        portals: {
            payer: {
                role: 'Payer Administrator',
                views: {
                    dashboard: { title: 'Dashboard', icon: 'ðŸ“Š', render: () => document.getElementById('payer-dashboard-template').innerHTML, postRender: (app) => app.Payer.initDashboard() },
                    validation: { title: 'Validation', icon: 'âš¡', render: () => document.getElementById('payer-validation-template').innerHTML, postRender: (app) => app.Payer.initValidation() },
                }
            },
            provider: {
                role: 'Provider',
                views: { profile: { title: 'My Profile', icon: 'ðŸ‘¤', render: () => document.getElementById('provider-profile-template').innerHTML, postRender: (app) => app.Provider.initProfile() } }
            },
            member: {
                role: 'Member',
                views: { directory: { title: 'Provider Directory', icon: 'ðŸ”', render: () => document.getElementById('member-directory-template').innerHTML, postRender: (app) => app.Member.initDirectory() } }
            }
        },
        Payer: {
            initDashboard() {
                this.renderPayerTable(App.state.providerData.filter(p => p.confidence !== 'High')); 
                this.createPayerCharts();
                document.querySelector('#dashboard-kpis').addEventListener('click', e => {
                    const card = e.target.closest('.kpi-card');
                    if(card) {
                        const filter = card.dataset.filter;
                        this.renderPayerTable(filter === "All" ? App.state.providerData : App.state.providerData.filter(p => p.confidence === filter));
                    }
                });
                document.getElementById('provider-table-body').addEventListener('click', e => {
                    if (e.target.dataset.action === 'review') this.showSmartReviewModal(parseInt(e.target.dataset.id));
                });
            },
            renderPayerTable(data) {
                const tableBody = document.getElementById('provider-table-body');
                if(!tableBody) return;
                const colors = {'Low':'bg-red-900/50 text-red-400','Medium':'bg-yellow-900/50 text-yellow-400'};
                tableBody.innerHTML = data.filter(p => p.confidence !== 'High').slice(0, 10).map(p => `<tr class="border-b border-[var(--border-color)] hover:bg-white/5"><td class="p-3 flex items-center"><img src="${p.profilePic}" class="w-8 h-8 rounded-full mr-3"/>${p.name}</td><td>${p.npi}</td><td class="text-yellow-400">${p.error}</td><td><span class="font-semibold px-2 py-1 rounded-full text-xs ${colors[p.confidence]}">${p.confidence}</span></td><td><button data-action="review" data-id="${p.id}" class="text-[var(--accent-blue)] font-semibold hover:underline">Review</button></td></tr>`).join('');
            },
            createPayerCharts() {
                const doughnutCtx = document.getElementById('errorsDoughnutChart');
                if(doughnutCtx && Chart.getChart(doughnutCtx)) { Chart.getChart(doughnutCtx).destroy(); }
                if(doughnutCtx) new Chart(doughnutCtx, { type: 'doughnut', data: { labels: ['Address Mismatch', 'Phone Unverified', 'License Expired', 'Specialty Mismatch'], datasets: [{ data: [3, 3, 3, 3], backgroundColor: ['#58A6FF', '#1F6FEB', '#F85149', '#D29922'], borderColor: '#161B22', borderWidth: 4 }] }, options: { responsive: true, maintainAspectRatio: false, cutout: '70%', plugins: { legend: { position: 'bottom', labels: { padding: 15, color: '#8B949E' } } } } });
            },
            initValidation() { document.getElementById('run-verification-btn').addEventListener('click', () => this.runVerificationProcess()); },
            runVerificationProcess() {
                const modal = document.getElementById('modal-container');
                modal.innerHTML = `<div class="card p-8 rounded-lg shadow-2xl w-full max-w-3xl"><h2 class="text-2xl font-bold mb-4">Live Validation Analysis</h2><div class="w-full bg-gray-700 rounded-full h-4 mb-4"><div id="progress-bar" class="bg-blue-600 h-4 rounded-full progress-bar-fill" style="width: 0%"></div></div><div class="grid grid-cols-3 gap-4 text-center mb-6"><div class="card p-4 rounded-lg"><h4>Profiles Processed</h4><p id="processed-count" class="text-2xl font-bold">0/200</p></div><div class="card p-4 rounded-lg"><h4>Errors Found</h4><p id="errors-count" class="text-2xl font-bold text-yellow-400">0</p></div><div class="card p-4 rounded-lg"><h4>PDFs Processed</h4><p id="pdf-count" class="text-2xl font-bold text-green-400">0/5</p></div></div><div id="verification-steps" class="h-48 overflow-y-auto bg-gray-900 rounded-lg p-4 font-mono text-xs"></div></div>`;
                modal.classList.remove('hidden'); modal.classList.add('flex');
                
                const steps = ["Initiating Batch Process...", "Data Validation Agent: ACTIVE - Cross-referencing NPI Registry...", "Data Validation Agent: ACTIVE - Scraping provider websites...", "Information Enrichment Agent: ACTIVE - Searching public sources...", "Processing Unstructured Data from 'License_scan.pdf'...", "Quality Assurance Agent: ACTIVE - Calculating confidence scores...", "Quality Assurance Agent: ACTIVE - Identifying discrepancies...", "Directory Management Agent: ACTIVE - Flagging 12 profiles...", "Process Complete."];
                const progressBar = document.getElementById('progress-bar');
                const processedCount = document.getElementById('processed-count');
                const errorsCount = document.getElementById('errors-count');
                const pdfCount = document.getElementById('pdf-count');
                const stepsContainer = document.getElementById('verification-steps');

                let i = 0, processed = 0, errors = 0, pdfs = 0;
                const interval = setInterval(() => {
                    if (i < steps.length) {
                        stepsContainer.innerHTML += `<div><span class="text-green-400">[${new Date().toLocaleTimeString()}]</span> <span class="text-secondary">${steps[i]}</span></div>`;
                        stepsContainer.scrollTop = stepsContainer.scrollHeight;
                        
                        processed = Math.min(200, processed + Math.floor(200 / steps.length));
                        progressBar.style.width = `${(processed/200)*100}%`;
                        processedCount.textContent = `${processed}/200`;
                        
                        if(steps[i].includes("Unstructured Data")) { pdfs++; pdfCount.textContent = `${pdfs}/5`; }
                        if(Math.random() > 0.6) { errors++; errorsCount.textContent = errors; }
                        
                        i++;
                    } else {
                        clearInterval(interval);
                        stepsContainer.innerHTML += `<div><span class="text-green-400 font-bold">[${new Date().toLocaleTimeString()}]</span> <span class="font-bold text-white">SUCCESS: Batch processed. Dashboard updated.</span></div>`;
                        setTimeout(() => modal.classList.add('hidden'), 3000);
                    }
                }, 1200);
            },
            showSmartReviewModal(id) {
                const provider = App.state.providerData.find(p => p.id === id);
                const modal = document.getElementById('modal-container');
                let modalContent = '';

                switch (provider.error) {
                    case 'License Expired':
                        modalContent = `<div class="card p-8 rounded-lg w-full max-w-lg text-center"><h2 class="text-xl font-bold text-red-400 mb-2">Compliance Alert!</h2><p class="text-secondary mb-6">${provider.name}</p><div class="bg-red-900/50 p-4 rounded-lg border border-red-700"><p>AI Agent has detected that this provider's license expired on <strong>15 Aug 2025</strong>.</p></div><div class="flex justify-center space-x-4 pt-6"><button id="modal-cancel" class="bg-gray-700 font-bold py-2 px-4 rounded-lg">Dismiss</button><button id="modal-reverify" class="bg-blue-600 text-white font-bold py-2 px-4 rounded-lg">Re-Verify with State Board</button></div></div>`;
                        break;
                    case 'Specialty Mismatch':
                         modalContent = `<div class="card p-8 rounded-lg w-full max-w-lg"><h2 class="text-xl font-bold mb-6">Resolve Specialty Mismatch: ${provider.name}</h2><div class="space-y-4"><div><p class="font-semibold text-secondary">Aegis Platform Data</p><p class="p-2 mt-1 rounded bg-gray-900 border border-[var(--border-color)]">${provider.specialty}</p></div><div><p class="font-semibold text-secondary">Hospital Website Data</p><p class="p-2 mt-1 rounded bg-gray-900 border border-[var(--border-color)]">Cardiac Surgery</p></div><div class="flex justify-end space-x-4 pt-4"><button id="modal-cancel" class="bg-gray-700 font-bold py-2 px-4 rounded-lg">Cancel</button><button id="modal-update-specialty" class="bg-green-600 text-white font-bold py-2 px-4 rounded-lg">Update to 'Cardiac Surgery'</button></div></div></div>`;
                        break;
                    default:
                        modalContent = `<div class="card p-8 rounded-lg w-full max-w-lg"><h2 class="text-xl font-bold mb-6">Review: ${provider.name}</h2><div class="space-y-4"><div><label class="font-semibold text-secondary">Phone</label><input id="modal-phone" type="text" value="${provider.phone}" class="w-full p-2 mt-1 rounded bg-transparent border border-[var(--border-color)]"></div><div><label class="font-semibold text-secondary">Address</label><input id="modal-address" type="text" value="${provider.address}" class="w-full p-2 mt-1 rounded bg-transparent border border-[var(--border-color)]"></div><div class="flex justify-end space-x-4 pt-4"><button id="modal-cancel" class="bg-gray-700 font-bold py-2 px-4 rounded-lg">Cancel</button><button id="modal-save" class="bg-green-600 text-white font-bold py-2 px-4 rounded-lg">Save & Verify</button></div></div>`;
                        break;
                }
                modal.innerHTML = modalContent;
                modal.classList.remove('hidden'); modal.classList.add('flex');
                
                document.getElementById('modal-cancel').onclick = () => modal.classList.add('hidden');
                if(document.getElementById('modal-save')) document.getElementById('modal-save').onclick = () => this.saveProvider(id, 'default');
                if(document.getElementById('modal-reverify')) document.getElementById('modal-reverify').onclick = () => this.saveProvider(id, 'reverify');
                if(document.getElementById('modal-update-specialty')) document.getElementById('modal-update-specialty').onclick = () => this.saveProvider(id, 'specialty');
            },
            saveProvider(id, type) {
                const provider = App.state.providerData.find(p => p.id === id);
                if (type === 'default') {
                    provider.phone = document.getElementById('modal-phone').value;
                    provider.address = document.getElementById('modal-address').value;
                } else if (type === 'specialty') {
                    provider.specialty = 'Cardiac Surgery';
                }
                provider.confidence = 'High'; provider.error = 'None';
                document.getElementById('modal-container').classList.add('hidden');
                this.renderPayerTable(App.state.providerData);
            }
        },
        Provider: {
            initProfile() {
                 const provider = App.state.providerData.find(p => p.id === App.state.loggedInProviderId);
                 document.getElementById('provider-name').textContent = provider.name;
                 document.getElementById('provider-npi').textContent = provider.npi;
                 document.getElementById('provider-specialty').value = provider.specialty;
                 document.getElementById('provider-phone').value = provider.phone;
                 document.getElementById('provider-address').value = provider.address;
                 if(provider.confidence !== 'High') { document.getElementById('provider-alert').classList.remove('hidden'); }
                 document.getElementById('provider-submit-btn').onclick = () => this.submitCorrection();
            },
            submitCorrection() {
                const provider = App.state.providerData.find(p => p.id === App.state.loggedInProviderId);
                provider.specialty = document.getElementById('provider-specialty').value;
                provider.phone = document.getElementById('provider-phone').value;
                provider.address = document.getElementById('provider-address').value;
                provider.confidence = 'High'; provider.error = 'None';
                const alertBox = document.getElementById('provider-alert');
                alertBox.innerHTML = `<h4 class="font-bold text-green-400">âœ… Thank You!</h4><p>Your information has been updated and re-verified.</p>`;
                alertBox.className = 'p-4 mb-6 bg-green-900/50 text-green-300 border border-green-700 rounded-lg';
            }
        },
        Member: {
            initDirectory() {
                this.renderMemberCards(App.state.providerData.filter(p => p.confidence === 'High'));
                const searchInput = document.getElementById('member-search-input');
                const voiceSearchBtn = document.getElementById('voice-search-btn');
                
                const filterAndRender = () => {
                    const searchTerm = searchInput.value.toLowerCase();
                    const filteredData = App.state.providerData.filter(p => p.confidence === 'High' && (p.name.toLowerCase().includes(searchTerm) || p.address.toLowerCase().includes(searchTerm) || p.specialty.toLowerCase().includes(searchTerm)));
                    this.renderMemberCards(filteredData);
                    this.renderSpecialtyChart(filteredData, searchTerm);
                };
                
                searchInput.addEventListener('input', filterAndRender);
                
                if ('webkitSpeechRecognition' in window) {
                    const recognition = new webkitSpeechRecognition();
                    recognition.continuous = false; recognition.lang = 'en-IN';
                    recognition.onstart = () => voiceSearchBtn.classList.add('listening');
                    recognition.onend = () => voiceSearchBtn.classList.remove('listening');
                    recognition.onerror = () => voiceSearchBtn.classList.remove('listening');
                    recognition.onresult = (event) => { searchInput.value = event.results[0][0].transcript; filterAndRender(); };
                    voiceSearchBtn.addEventListener('click', () => recognition.start());
                } else { voiceSearchBtn.style.display = 'none'; }

                document.getElementById('member-results-container').addEventListener('click', e => {
                     if (e.target.dataset.action === 'book') this.showBookingModal(parseInt(e.target.dataset.id));
                });
            },
            renderMemberCards(data) {
                document.getElementById('member-results-container').innerHTML = data.map(p => `
                    <div class="card p-4 rounded-lg flex items-center justify-between">
                        <div class="flex items-center">
                            <img src="${p.profilePic}" class="w-16 h-16 rounded-full mr-4"/>
                            <div>
                                <h4 class="font-bold text-lg">${p.name}</h4>
                                <p class="text-secondary">${p.specialty} - ${p.address.split(',')[1].trim()}</p>
                            </div>
                        </div>
                        <button data-action="book" data-id="${p.id}" class="bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700">Book</button>
                    </div>`).join('');
            },
            renderSpecialtyChart(data, searchTerm) {
                const chartContainer = document.getElementById('specialty-chart-container');
                if (App.state.charts.specialty) App.state.charts.specialty.destroy();
                
                const cityMatch = searchTerm.match(/delhi|mumbai|bangalore|chennai|kolkata|hyderabad|pune|ahmedabad|jaipur/i);
                if (!cityMatch) { chartContainer.classList.add('hidden'); return; }
                
                chartContainer.classList.remove('hidden');
                const specialtyCounts = data.reduce((acc, p) => { acc[p.specialty] = (acc[p.specialty] || 0) + 1; return acc; }, {});
                const sortedSpecialties = Object.entries(specialtyCounts).sort((a, b) => b[1] - a[1]);
                const chartCtx = document.getElementById('specialtyChart').getContext('2d');
                App.state.charts.specialty = new Chart(chartCtx, {
                    type: 'bar', data: { labels: sortedSpecialties.map(s => s[0]), datasets: [{ label: 'Number of Specialists', data: sortedSpecialties.map(s => s[1]), backgroundColor: '#3B82F6' }] },
                    options: { indexAxis: 'y', responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { y: { ticks: { color: '#8B949E' } }, x: { ticks: { color: '#8B949E' } } } }
                });
            },
            showBookingModal(id) {
                const provider = App.state.providerData.find(p => p.id === id);
                const modal = document.getElementById('modal-container');
                modal.innerHTML = `<div class="card p-8 rounded-lg w-full max-w-md"><h2 class="text-xl font-bold mb-2">Book Appointment</h2><p class="text-secondary mb-6">with ${provider.name}</p><div><label class="font-semibold">Select Date:</label><input type="date" class="w-full p-2 mt-1 rounded bg-transparent border border-[var(--border-color)]"></div><div class="mt-4"><p class="font-semibold mb-2">Available Times:</p><div class="grid grid-cols-3 gap-2" id="time-slots"><button class="time-slot p-2 rounded border border-[var(--border-color)] hover:bg-blue-800">09:00 AM</button><button class="time-slot p-2 rounded border border-[var(--border-color)] hover:bg-blue-800">11:30 AM</button><button class="time-slot p-2 rounded border border-[var(--border-color)] hover:bg-blue-800">02:00 PM</button></div></div><div class="flex justify-end space-x-4 pt-6"><button id="modal-cancel" class="bg-gray-700 font-bold py-2 px-4 rounded-lg">Cancel</button><button id="modal-confirm" class="bg-green-600 text-white font-bold py-2 px-4 rounded-lg">Confirm</button></div></div>`;
                modal.classList.remove('hidden'); modal.classList.add('flex');
                document.getElementById('modal-cancel').onclick = () => modal.classList.add('hidden');
                document.getElementById('time-slots').onclick = e => { if(e.target.tagName === 'BUTTON') { document.querySelectorAll('.time-slot').forEach(b => b.classList.remove('selected')); e.target.classList.add('selected'); } };
                document.getElementById('modal-confirm').onclick = () => {
                     modal.innerHTML = `<div class="card p-8 rounded-lg text-center"><h2 class="text-2xl font-bold text-green-400 mb-4">âœ… Appointment Confirmed!</h2><p>Your appointment with ${provider.name} is confirmed. You will receive an email shortly.</p></div>`;
                     setTimeout(() => modal.classList.add('hidden'), 3000);
                }
            }
        }
    };
    App.init();
    </script>
    
    <template id="payer-dashboard-template"><div id="dashboard-kpis" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6"><div class="kpi-card card p-5 rounded-lg" data-filter="All"><h4 class="font-semibold text-secondary">Total Providers</h4><p class="text-3xl font-bold">15,780</p></div><div class="kpi-card card p-5 rounded-lg" data-filter="High"><h4 class="font-semibold text-secondary">High Confidence</h4><p class="text-3xl font-bold text-[var(--accent-green)]">97.8%</p></div><div class="kpi-card card p-5 rounded-lg" data-filter="Medium"><h4 class="font-semibold text-secondary">Medium Confidence</h4><p class="text-3xl font-bold text-[var(--accent-yellow)]">1.5%</p></div><div class="kpi-card card p-5 rounded-lg" data-filter="Low"><h4 class="font-semibold text-secondary">Compliance Flags</h4><p class="text-3xl font-bold text-[var(--accent-red)]">0.7%</p></div></div><div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6"><div class="lg:col-span-2 card p-6 rounded-lg"><h3 class="text-lg font-semibold mb-4">Error Types Breakdown</h3><div class="h-80"><canvas id="errorsDoughnutChart"></canvas></div></div><div class="card p-6 rounded-lg"><h3 class="text-lg font-semibold mb-4">Live Status</h3><p class="text-secondary">Real-time data source monitoring...</p></div></div><div class="card p-6 rounded-lg"><h3 class="text-lg font-semibold mb-4">Provider Action Queue</h3><div class="overflow-x-auto"><table class="w-full text-left"><thead><tr class="border-b border-[var(--border-color)]"><th class="p-3 font-semibold">Provider</th><th>NPI</th><th>Error</th><th>Confidence</th><th>Action</th></tr></thead><tbody id="provider-table-body"></tbody></table></div></div></template>
    <template id="payer-validation-template"><div class="card p-6 rounded-lg text-center"><h2 class="text-2xl font-bold mb-4">Automated Validation & Onboarding</h2><p class="text-secondary mb-6">Process a new batch of provider data to validate, enrich, and identify issues.</p><button id="run-verification-btn" class="bg-blue-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-700 transition-all text-lg">Start New Batch</button></div></template>
    <template id="provider-profile-template"><div class="card p-8 rounded-lg max-w-3xl mx-auto"><div id="provider-alert" class="p-4 mb-6 bg-yellow-900/50 text-yellow-300 border border-yellow-700 rounded-lg hidden"><h4 class="font-bold">Action Required!</h4><p>Our system has detected a potential inaccuracy. Please review and submit corrections.</p></div><h2 class="text-2xl font-bold mb-6" id="provider-name"></h2><div class="space-y-4"><div><label class="font-semibold block mb-1 text-secondary">NPI Number</label><p id="provider-npi" class="text-lg"></p></div><div><label class="font-semibold block mb-1 text-secondary">Specialty</label><input type="text" id="provider-specialty" class="w-full p-2 rounded bg-transparent border border-[var(--border-color)]"></div><div><label class="font-semibold block mb-1 text-secondary">Phone</label><input type="text" id="provider-phone" class="w-full p-2 rounded bg-transparent border border-[var(--border-color)]"></div><div><label class="font-semibold block mb-1 text-secondary">Address</label><input type="text" id="provider-address" class="w-full p-2 rounded bg-transparent border border-[var(--border-color)]"></div><button id="provider-submit-btn" class="w-full bg-green-600 text-white font-bold py-3 mt-6 rounded-lg hover:bg-green-700">Submit Corrections</button></div></div></template>
    <template id="member-directory-template"><div class="card p-6 rounded-lg"><h2 class="text-2xl font-bold mb-4">Find a Verified Provider</h2><div class="relative w-full mb-6"><input id="member-search-input" type="text" placeholder="Search by name, specialty, or city..." class="w-full p-3 pl-4 pr-12 rounded-lg border border-[var(--border-color)] bg-transparent"><button id="voice-search-btn" title="Search by voice" class="absolute right-3 top-1/2 -translate-y-1/2 text-2xl text-secondary hover:text-primary transition-colors">ðŸŽ¤</button></div><div class="grid grid-cols-1 md:grid-cols-3 gap-6"><div id="specialty-chart-container" class="md:col-span-1 card p-4 rounded-lg hidden"><h3 class="font-bold text-center mb-2">Specialist Distribution</h3><div class="h-64"><canvas id="specialtyChart"></canvas></div></div><div id="member-results-container" class="md:col-span-2 space-y-4"></div></div></div></template>
</body>
</html>